<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Settings</title>
    <link rel="stylesheet" href="../public/styles.css">
  </head>
  <body>
    <div class="container">
      <h1>Settings</h1>
      
      <div class="setting-group">
        <label for="webPort">Web Server Port</label>
        <input type="number" id="webPort" placeholder="3000" value="3000">
      </div>
      
      <div class="button-group">
        <button class="btn-save" onclick="saveSettings()">Save Settings</button>
        <button class="btn-cancel" onclick="window.close()">Cancel</button>
      </div>
      
      <div class="status-message" id="statusMessage"></div>
    </div>
    
    <script>
      async function saveSettings() {
        const settings = {
          webPort: parseInt(document.getElementById('webPort').value),
        };
        
        try {
          const result = await window.electron.saveSettings(settings);
          if (result.success) {
            showMessage('Settings saved successfully!', 'success');
            setTimeout(() => window.close(), 1500);
          }
        } catch (error) {
          showMessage('Error saving settings: ' + error.message, 'error');
        }
      }
      
      function showMessage(message, type) {
        const statusEl = document.getElementById('statusMessage');
        statusEl.textContent = message;
        statusEl.className = 'status-message ' + type;
      }
      
      // Load settings on window open
      window.addEventListener('DOMContentLoaded', async () => {
        try {
          const result = await window.electron.loadSettings();
          if (result.success && result.data) {
            // Populate form fields with saved settings
            if (result.data.webPort) {
              document.getElementById('webPort').value = result.data.webPort;
            }
          }
        } catch (error) {
          console.error('Failed to load settings:', error);
        }
      });
    </script>
  </body>
</html>
